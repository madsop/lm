{
  "name": "intercom",
  "version": "0.5.1",
  "description": "Create child processes with dnode-protocol based event communication over the nodejs IPC channel, with monitor and control functions for the lifecycle of the created child process.",
  "author": {
    "name": "Sander Tolsma",
    "email": "sander at tolsma.net"
  },
  "repository": {
    "type": "git",
    "url": "http://github.com/stolsma/intercom.git"
  },
  "main": "./lib/intercom",
  "dependencies": {
    "dnode-protocol": "0.2.x",
    "eventemitter2": "0.4.x"
  },
  "devDependencies": {
    "vows": "0.6.x >=0.6.0"
  },
  "scripts": {
    "test": "vows test/**/*-test.js --isolate --spec"
  },
  "engines": {
    "node": "0.8.x || 0.9.x"
  },
  "readme": "# Intercom\n\n*Create child processes with dnode-protocol based event communication over the nodejs IPC channel, with monitor and control functions for the lifecycle of the created child process*\n\nImportant: per Intercom version 0.5.0 the behavior of the 'exit' event changed!!! Added is the 'close' event as direct replacement for the old 'exit' event. See below for more information.\n\n# Installing Intercom\n\n`intercom` can be installed from NPM with:\n\n    npm install intercom\n\n# Using Intercom\n\nThe code almost speaks for itself: see the example directories showing visisble and invisible examples!!\n\nFollowing is a invisible example of intercom use.\n\nParent code example (intercom.js):\n\n``` javascript\nvar path = require('path'),\n    Child = require('../../lib/intercom').EventChild;\n\nvar child = Child(path.join(__dirname, 'child.js'));\n\nchild.on('stdout', function(txt) {\n  console.log('child stdout: ' + txt);\n});\n\nchild.on('stderr', function(txt) {\n  console.log('child stderr: ' + txt);\n});\n\nchild.on('child::message', function(text) {\n  console.log('Parent: Child says: ', text);\n  child.emit('parent::message', 'This is your parent!');\n});\n\nchild.on('child::quit', function() {\n  console.log('Parent: Child wants to quit!');\n  process.nextTick(function(){\n    child.stop();\n  });\n});\n\nchild.start();\n```\n\nChild code example (child.js):\n\n``` javascript\nprocess.parent.ready(function() {\n  console.log('Comms Ready, sending message!');\n  process.parent.emit('child::message', 'I am alive!');\n});\n\nprocess.parent.on('parent::message', function(text) {\n  console.log('The parent says: ', text);\n  process.nextTick(function() {\n    process.parent.emit('child::quit');\n  });\n});\n\nconsole.log('Child is setup!!');\n```\n\nOutput when run with `node example/visible/intercom.js`:\n\n```\nchild stdout: Child is setup!!\n\nchild stdout: Comms Ready, sending message!\n\nParent: Child says:  I am alive!\nchild stdout: The parent says:  This is your parent!\n\nParent: Child wants to quit!\n```\n\n\n# Code documentation\n\n## The EventChild class\n\nThe `EventChild` class is able to fork and control the lifecycle of a child process with a dnode-protocol based event channel between parent and child process.\nEvents emitted on the `EventChild` instance created in the child process are transported to the mirror `process.parent` instance in the child process and emitted there too! \n\nThe `EventChild` class has 9 important functions:\n\n  * `constructor(script, options)` The constructor takes two arguments: `script` and `options`. The script is the script to start in the child process. The options are described in the options section.\n  * `start()` Start the target script in a new child process (if not already started) and starts up the event communication channel.\n  * `ready(readyFn)` Execute the given function when the event channel with the child is ready\n  * `emit(event, [argument1], [argument2]...[argumentx])` Emit an event on the child `process.parent` instance.\n  * `localEmit(event, [argument1], [argument2]...[argumentx])` Emit a local event on the EventChild instance. This event is not being send to the child `process.parent` instance.\n  * `on(event, callback)` React on a defined child event.\n  * `onAny(callback)`  React on any child event.\n  * `restart()`  Restarts the target script child process associated with this instance.\n  * `stop()` Stops the target script associated with this instance. Prevents it from auto-respawning.  \n  * `disconnect()` Disconnects and closes the IPC channel and the RPC session but lets the child running.  \n  \nSee [EventEmitter2](https://github.com/hij1nx/EventEmitter2) for more information on the `emit`, `on`, `onAny` and other function standard available on EventEmitter2 classes.  \n  \n### Constructor options\n\n``` js\n  {\n    // Basic configuration options\n    'eventOptions': {           // Options for the EventEmitter2 constructor. See EventEmitter2!!\n       delimiter: '::',\n       wildcard: true\n     },\n    'max': 10,                  // Sets the maximum number of times a given script should run (undefined = forever)\n    \n    // These options control how quickly parent restarts a child process\n    // as well as when to kill a \"spinning\" process\n    'minUptime': 2000,          // Minimum time a child process has to be up. EventChild will 'exit' otherwise.\n    'spinSleepTime': 1000,      // Interval between restarts if a child is spinning (i.e. alive < minUptime).\n    \n    // Command to spawn as well as options and other vars \n    // (env, cwd, etc) to pass along\n    'options': ['foo','bar'],   // Additional arguments to pass to the script,\n    'sourceDir': 'script/path'  // Directory that the source script is in\n    \n    // All or nothing options passed along to `child_process.fork`. See for more info the NodeJS documentation.\n    'spawnWith': {},\n    \n    // More specific options to pass along to `child_process.spawn` which \n    // will override anything passed to the `spawnWith` option\n    'env': { 'ADDITIONAL': 'CHILD ENV VARS' }\n    'cwd': '/path/to/child/working/directory'\n    'silent': true,             // Silences the output from stdout and stderr in the parent process\n  }\n```\n\n### Standard events when using an instance of EventChild\n\nEach EventChild instance is an descendant of EventEmitter2. There are also several core events that you can listen for. This are also the events types you cannot use to send over de communication channel!!:\n\n* **error**         _[err, info]:_              Raised when an error occurs\n* **start**         _[child_data]:_             Raised when the target script is first started\n* **stop**          _[child_data]:_             Raised when the target script is stopped by the user\n* **restart**       _[child_data]:_             Raised each time the target script is restarted\n* **exit**          _[code, signal]:_           Raised when the target script process actually exits (before restart dec\n* **close**         _[spinning, code, signal]_  Raised when the target script actually exits permenantly.\n* **disconnect**    _[]_                        Raised when disconnection from the IPC channel is requested\n* **disconnected**  _[]_                        Raised when the IPC channel is disconnected\n* **stdout**        _[data]:_                   Raised when data is received from the child process' stdout\n* **stderr**        _[data]:_                   Raised when data is received from the child process' stderr\n* **warn**          _[err, info]:_              Raised when something unexpected happens but there's no need to break the codeflow\n\n\nThe following two events are related to the dnode-protocol RPC session:\n\n* **rpcready**      _[]:_                       Raised when the dnode-protocol RPC session is up and running and events can be send and received\n* **rpcexit**       _[]:_                       Raised when the dnode-protocol RPC session has ended. events won't be send to the child process anymore.\n\n\n## The Child Process\n\nThe `intercom` module automatically creates a dnode-protocol based event channel between parent and child process when a, by fork created, `message` event and `send()` function are detected.\nEvents emitted on the `process.parent` instance are transported to the mirror `EventChild` class in the parent process and emitted there too! \n\nThe `process.parent` instance has 5 important functions:\n\n  * `ready(readyFn)` Execute the given function when the event channel with the parent is ready\n  * `emit(event, [argument1], [argument2]...[argumentx])` Emit an event on the parent process `EventChild` instance.\n  * `localEmit(event, [argument1], [argument2]...[argumentx])` Emit a local event on the `process.parent` instance. This event is not being send to the parent `EventChild` instance.\n  * `on(event, callback)` React on a (parent) event. \n  * `onAny(callback)`  React on any (parent) events.\n  * `disconnect()` Disconnects and closes the IPC channel and the RPC session but lets the child running until its done or `exit` is called .  \n  \nSee [EventEmitter2](https://github.com/hij1nx/EventEmitter2) for more information on the `emit`, `on` `onAny` and other function standard available on EventEmitter2 classes.  \n\n### Standard events when using `process.parent`\n\nEach `process.parent` instance is a descendant of EventEmitter2. There are also several core events that you can listen for. This are also the events types you cannot use to send over de communication channel!!:\n\n* **disconnect**    _[]_                        Raised when disconnection from the IPC channel is requested\n* **disconnected**  _[]_                        Raised when the IPC channel is disconnected\n* **error**         _[err, info]:_              Raised when an error occurs\n* **warn**          _[err, info]:_              Raised when something unexpected happens but there is no need to break the codeflow\n\nThe following two events are related to the dnode-protocol RPC session:\n\n* **rpcready**      _[]:_                       Raised when the dnode-protocol RPC session is up and running and events can be send and received\n* **rpcexit**       _[]:_                       Raised when the dnode-protocol RPC session has ended. events won't be send to the child process anymore.\n\n\nDocumentation License\n=====================\n\nCreative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License\n\nhttp://creativecommons.org/licenses/by-nc-sa/3.0/\n\nCopyright (c)2011 [TTC](http://www.tolsma.net)/[Sander Tolsma](http://sander.tolsma.net/)\n\n\nCode License\n============\n\n[MIT License](http://www.opensource.org/licenses/mit-license.php)\n\nCopyright (c)2011 [TTC](http://www.tolsma.net)/[Sander Tolsma](http://sander.tolsma.net/)\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.",
  "_id": "intercom@0.5.1",
  "dist": {
    "shasum": "622618fc74a4385b390652092842d08f57d7bd4f",
    "tarball": "http://registry.npmjs.org/intercom/-/intercom-0.5.1.tgz"
  },
  "_npmVersion": "1.1.49",
  "_npmUser": {
    "name": "stolsma",
    "email": "npm@tolsma.net"
  },
  "maintainers": [
    {
      "name": "stolsma",
      "email": "npm@tolsma.net"
    }
  ],
  "directories": {},
  "_shasum": "622618fc74a4385b390652092842d08f57d7bd4f",
  "_resolved": "https://registry.npmjs.org/intercom/-/intercom-0.5.1.tgz",
  "_from": "intercom@*"
}
